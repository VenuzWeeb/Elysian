package com.elysian.client.module.modules.exploit;

import com.elysian.client.module.ModuleType;
import com.elysian.client.module.ToggleableModule;
import com.elysian.client.property.NumberProperty;

import net.minecraft.entity.monster.EntityMob;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.ItemStack;
import net.minecraft.item.ItemSword;
import net.minecraft.util.EnumHand;
import net.minecraftforge.fml.common.gameevent.TickEvent;

public final class Reach extends ToggleableModule {
    private final NumberProperty<Integer> range = new NumberProperty<>(4, 3, 7, "Range");

    private double distance;

    public Reach() {
        super("Reach", new String[] {"Reach"}, "Allows you the reach players", ModuleType.EXPLOIT);
        this.offerProperties(this.range, this.keybind);
    }

    @Override
    public void update(TickEvent event) {
        if (mc.player.getHeldItem(EnumHand.MAIN_HAND).getItem() instanceof ItemSword && mc.gameSettings.keyBindAttack.isKeyDown()) {
            mc.world.getLoadedEntityList().forEach(e -> {
                distance = mc.player.getDistanceSq(e);
                if (e instanceof EntityPlayer && distance <= (double) Reach.this.range.getValue() && e.getName() != mc.player.getName()) {
                    mc.playerController.attackEntity(mc.player, e);
                }

                if (e instanceof EntityMob && distance <= (double) Reach.this.range.getValue()) {
                    mc.playerController.attackEntity(mc.player, e);
                }
            });
        }
    }
}
