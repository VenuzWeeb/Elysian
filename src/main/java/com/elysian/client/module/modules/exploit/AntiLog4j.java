package com.elysian.client.module.modules.exploit;

import net.minecraft.network.play.server.SPacketChat;
import net.minecraftforge.client.event.RenderWorldLastEvent;
import net.minecraftforge.fml.common.gameevent.TickEvent;

import com.elysian.client.command.Command;
import com.elysian.client.event.events.InputEvent;
import com.elysian.client.event.events.PacketEvent;
import com.elysian.client.module.ModuleType;
import com.elysian.client.module.ToggleableModule;

public class AntiLog4j extends ToggleableModule {

    public AntiLog4j() {
        super("AntiLog4j", new String[] {"AntiLog"}, "Prevents the AntiLog4j Exploit", ModuleType.EXPLOIT);
        this.offerProperties(this.keybind);
    }

    @Override
    public void packet(PacketEvent event) {
        String text;
        if (event.getPacket() instanceof SPacketChat && ((text = ((SPacketChat)event.getPacket()).getChatComponent().getUnformattedText()).contains("${") || text.contains("$<") || text.contains("$:-") || text.contains("jndi:ldap"))) {
            Command.sendClientSideMessage("&c[AntiLog4j] &cBlocked message: " + text);
            event.setCancelled(true);;
        }
    }

}
